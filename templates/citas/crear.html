{% extends "admin_base.html" %}

{% block title %}Nueva Cita - Sistema Médico Universitario{% endblock %}

{% block content %}
<!-- Dashboard Header -->
<div class="admin-header">
    <div>
        <h1 class="admin-header-title">Nueva Cita Médica</h1>
        <p class="admin-header-subtitle">Complete todos los campos para programar una nueva cita médica</p>
        <small class="admin-status">Formulario de programación de citas</small>
    </div>
    <div class="admin-header-actions">
        <a href="{{ url_for('citas.lista') }}" class="admin-btn admin-btn-secondary">
            <i class='bx bx-arrow-back'></i>
            Volver a Citas
        </a>
    </div>
</div>

<!-- Formulario de Nueva Cita -->
<div class="admin-table-container">
    <div class="admin-table-header">
        <div class="admin-table-title">Información de la Cita</div>
        <div style="color: var(--admin-text-secondary); font-size: 14px;">
            Complete la información para programar la cita médica
        </div>
    </div>
    <div style="padding: 30px;">
        <form method="POST">
            {{ form.hidden_tag() }}
            
            <!-- Participantes -->
            <div style="margin-bottom: 30px;">
                <h5 style="color: var(--admin-text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                    <i class='bx bx-user'></i> Participantes
                </h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--admin-text-primary);">
                            <i class='bx bx-user-circle'></i> {{ form.paciente_id.label.text }}
                        </label>
                        {{ form.paciente_id(style="width: 100%; padding: 12px; border: 1px solid var(--admin-border); border-radius: 6px; background: var(--admin-bg);") }}
                        {% if form.paciente_id.errors %}
                            {% for error in form.paciente_id.errors %}
                                <div style="color: #dc3545; font-size: 12px; margin-top: 4px;">{{ error }}</div>
                            {% endfor %}
                        {% endif %}
                        <small style="color: var(--admin-text-secondary); font-size: 12px;">Selecciona el estudiante que recibirá la atención médica</small>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--admin-text-primary);">
                            <i class='bx bx-user-check'></i> {{ form.profesional_id.label.text }}
                        </label>
                        {{ form.profesional_id(style="width: 100%; padding: 12px; border: 1px solid var(--admin-border); border-radius: 6px; background: var(--admin-bg);") }}
                        {% if form.profesional_id.errors %}
                            {% for error in form.profesional_id.errors %}
                                <div style="color: #dc3545; font-size: 12px; margin-top: 4px;">{{ error }}</div>
                            {% endfor %}
                        {% endif %}
                        <small style="color: var(--admin-text-secondary); font-size: 12px;">Asigna el médico o psicólogo que atenderá</small>
                    </div>
                </div>
            </div>
            
            <!-- Programación -->
            <div style="margin-bottom: 30px;">
                <h5 style="color: var(--admin-text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                    <i class='bx bx-time'></i> Programación de la Cita
                </h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--admin-text-primary);">
                            <i class='bx bx-calendar'></i> {{ form.fecha.label.text }}
                        </label>
                        {{ form.fecha(style="width: 100%; padding: 12px; border: 1px solid var(--admin-border); border-radius: 6px; background: var(--admin-bg);") }}
                        {% if form.fecha.errors %}
                            {% for error in form.fecha.errors %}
                                <div style="color: #dc3545; font-size: 12px; margin-top: 4px;">{{ error }}</div>
                            {% endfor %}
                        {% endif %}
                        <small style="color: var(--admin-text-secondary); font-size: 12px;">Fecha de la consulta médica</small>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--admin-text-primary);">
                            <i class='bx bx-time-five'></i> {{ form.hora.label.text }}
                        </label>
                        {{ form.hora(style="width: 100%; padding: 12px; border: 1px solid var(--admin-border); border-radius: 6px; background: var(--admin-bg);") }}
                        {% if form.hora.errors %}
                            {% for error in form.hora.errors %}
                                <div style="color: #dc3545; font-size: 12px; margin-top: 4px;">{{ error }}</div>
                            {% endfor %}
                        {% endif %}
                        <small style="color: var(--admin-text-secondary); font-size: 12px;">Hora de inicio de la consulta</small>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--admin-text-primary);">
                            <i class='bx bx-medical'></i> {{ form.tipo_cita.label.text }}
                        </label>
                        {{ form.tipo_cita(style="width: 100%; padding: 12px; border: 1px solid var(--admin-border); border-radius: 6px; background: var(--admin-bg);") }}
                        {% if form.tipo_cita.errors %}
                            {% for error in form.tipo_cita.errors %}
                                <div style="color: #dc3545; font-size: 12px; margin-top: 4px;">{{ error }}</div>
                            {% endfor %}
                        {% endif %}
                        <small style="color: var(--admin-text-secondary); font-size: 12px;">Tipo de consulta a realizar</small>
                    </div>
                </div>
            </div>
            
            <!-- Detalles -->
            <div style="margin-bottom: 30px;">
                <h5 style="color: var(--admin-text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                    <i class='bx bx-note'></i> Detalles de la Cita
                </h5>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--admin-text-primary);">
                        <i class='bx bx-message-detail'></i> {{ form.motivo.label.text }}
                    </label>
                    {{ form.motivo(rows="4", style="width: 100%; padding: 12px; border: 1px solid var(--admin-border); border-radius: 6px; background: var(--admin-bg); resize: vertical;", placeholder="Describe el motivo de la consulta, síntomas o razón de la cita...") }}
                    {% if form.motivo.errors %}
                        {% for error in form.motivo.errors %}
                            <div style="color: #dc3545; font-size: 12px; margin-top: 4px;">{{ error }}</div>
                        {% endfor %}
                    {% endif %}
                    <small style="color: var(--admin-text-secondary); font-size: 12px;">Proporciona información adicional sobre el motivo de la consulta</small>
                </div>
            </div>
            
            <!-- Botones de Acción -->
            <div style="display: flex; justify-content: center; gap: 15px; margin-top: 30px;">
                <a href="{{ url_for('citas.lista') }}" class="admin-btn admin-btn-secondary">
                    <i class='bx bx-arrow-back'></i> Cancelar
                </a>
                <button type="submit" class="admin-btn admin-btn-success">
                    <i class='bx bx-check-circle'></i> Crear Cita Médica
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
